{% extends 'reports/_layout.html' %}

{% block content %}
	<h3>Competitions
{% if items %}
		<a class="button" href="{{ csv_href ~ 'competitions' }}">Download Email Addresses</a>
{% endif %}
	</h3>

{% for item in items %}

	<h4>{{ item.name }}
	{%- if item.meta != 'position' -%}
		{{ ' (%d)' | format(item.count_registrations) }}
	{%- else -%}
		{{ ' (%s)' | format(item.registrations_by_position) }}
	{%- endif -%}
	</h4>
	<table class="widefat page fixed report">
		<thead>
			<tr>
				<th class="manage-column column-title"><div>Name</div></th>
{% if item.meta == 'position' %}
				<th class="manage-column"><div>Position</div></th>
{% elseif item.meta == 'partner_name' %}
				<th class="manage-column"><div>Partner</div></th>
{% elseif item.meta == 'team_members' %}
				<th class="manage-column"><div>Team Members</div></th>
{% endif %}
			</tr>
		</thead>

		<tfoot>
			<tr>
				<th class="manage-column column-title"><div>Name</div></th>
{% if item.meta == 'position' %}
				<th class="manage-column"><div>Position</div></th>
{% elseif item.meta == 'partner_name' %}
				<th class="manage-column"><div>Partner</div></th>
{% elseif item.meta == 'team_members' %}
				<th class="manage-column"><div>Team Members</div></th>
{% endif %}
			</tr>
		</tfoot>

		<tbody>
{% for dancer in item.registered_dancers %}
			<tr {{- cycle(['', ' class="alternate"'], loop.index) | raw }}>
				<td class="column-title"><a href="{{ request_href ~ 'report_dancer' ~ '&dancer_id=' ~ dancer.id }}">{{ dancer.name }}</a></td>
{% if item.meta in ['position', 'partner_name', 'team_members'] %}
				<td>{{ dancer.item_meta | title }}</td>
{% endif %}
			</tr>

{% else %}
			<tr><td {%- if item.meta %} colspan="2" {%- endif %}>There are no registered dancers for this competition.</td></tr>
{% endfor %}
		</tbody>
	</table>
{% else %}
	<p>There aren't any competitions for this event.</p>
{% endfor %}
{% endblock content %}

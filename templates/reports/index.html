{% from 'admin/_layout.html' import message as message %}

<div id="reg-sys" class="wrap">
<div id="report_index">
	<h2>Registration Reports
{% if admin %}
		<a class="button add-new-h2" href="{{ request_href ~ 'admin_event_add' }}">Add New Event</a>
{% endif %}
		<a class="button add-new-h2" href="{{ request_href ~ 'report_index_visualization' }}">Load Visualization</a>
	</h2>
	{%- if GET.deleted_event %}{{ "\n\t\t" }}{{ message('Deleted %s%s.' | format((GET.registrations_only == 'true' ? 'registrations for ' : ''), GET.deleted_event), 'error') }}{% endif %}


	<h3>Choose Event</h3>

{% if events %}
	<table class="widefat page fixed report">
		<thead>
			<tr>
				<th class="manage-column column-title">Title</th>
				<th class="manage-column" width="24%">Mail Preregistration End Date</th>
				<th class="manage-column" width="25%">PayPal Preregistration End Date</th>
				<th class="manage-column" width="20%">No Refunds After</th>
{% if admin %}
				<th class="manage-column ellipsis" width="9%">Edit Event</th>
{% endif %}
			</tr>
		</thead>

		<tfoot>
			<tr>
				<th class="manage-column column-title">Title</th>
				<th class="manage-column">Mail Preregistration End Date</th>
				<th class="manage-column">PayPal Preregistration End Date</th>
				<th class="manage-column">No Refunds After</th>
{% if admin %}
				<th class="manage-column ellipsis">Edit Event</th>
{% endif %}
			</tr>
		</tfoot>

		<tbody>
{% for event in events %}
			<tr class="{{ cycle(['', 'alternate'], loop.index) }}{% if options.current_event_id == event.id %} current-event{% endif %}">
				<td class="column-title"><a href="{{ request_href ~ 'report_index_event' ~ '&event_id=' ~ event.id }}">{{ event.name }}</a></td>
				<td class="date">{% if event.date_mail_prereg_end %}{{ event.date_mail_prereg_end | date }}{% else %}&mdash;{% endif %}</td>
				<td class="date">{{ event.date_paypal_prereg_end | date }}</td>
				<td class="date">{{ event.date_refund_end | date }}</td>
{% if admin %}
				<td><a href="{{ request_href ~ 'admin_event_edit' ~ '&event_id=' ~ event.id }}">Edit Event</a></td>
{% endif %}
			</tr>

{% endfor %}
		</tbody>
	</table>
{% else %}
	<p>No events have been created yet.<p>
{% endif %}
</div>
</div>
